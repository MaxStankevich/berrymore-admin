(this["webpackJsonpberrymore-admin"]=this["webpackJsonpberrymore-admin"]||[]).push([[0],{1096:function(e,t,c){},1101:function(e,t,c){},1371:function(e,t,c){},1372:function(e,t,c){},1374:function(e,t,c){},1380:function(e,t,c){"use strict";c.r(t);c(768);var a=c(1),n=c(43),r=c(742),s=c.n(r),i=c(90),o=c.n(i),u=c(41),l=c(154),d=c(95),j=c(18),b=c(1383),m=c(247),O=c(1402),h=c(1403),f=c(1404),p=c(1405),x=c(1406),g=c(1407),y=c(17),v=c(432),I=Object(v.b)({name:"auth",initialState:{user:null},reducers:{setUser:function(e,t){e.user=t.payload}}}),S=I.actions.setUser,N=function(e){return e.auth.user},w=I.reducer,k=function(){var e=Object(l.b)(),t=Object(l.c)(N),c=Object(a.useMemo)((function(){return t||JSON.parse(localStorage.getItem("user"))||{}}),[t]),n=Object(a.useMemo)((function(){return c&&c.role&&"admin"===c.role.name}),[c]),r=Object(a.useCallback)((function(t){var a=Object(y.a)(Object(y.a)({},c),t);e(S(a)),localStorage.setItem("user",JSON.stringify(a))}),[c,e]);return[c,r,n]},F=c(124),C=c(1397),M=c(3),q=b.a.Header,E=function(){var e=Object(l.b)(),t=Object(d.f)();return Object(M.jsx)(q,{className:"site-layout-sub-header-background",children:Object(M.jsx)(F.a,{type:"primary",icon:Object(M.jsx)(C.a,{}),onClick:function(){e(S(null)),localStorage.removeItem("user"),localStorage.removeItem("token"),t.push("/")},children:"\u0412\u044b\u0439\u0442\u0438"})})},z=c(753),A=c(329),Y=c(1391),T=c(747),V=c(1394),D=c(749),J=c(1396),B=c(1388),P=c(102),_=c.n(P),K=c(752),W={1:"orange",2:"geekblue",3:"blue",4:"cyan",5:"lime",6:"purple",7:"green"},U=function(e){var t=e.id,c=e.name;return Object(M.jsx)(K.a,{color:W[t],children:c})},H=c(1395),L=c(706),R=c.n(L).a.create({baseURL:"/api/"});R.interceptors.request.use((function(e){var t=localStorage.getItem("token");return t&&(e.headers["x-access-token"]=t),e}),(function(e){return Promise.reject(e)})),R.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status&&z.a.error({message:e.response.data.message||"\u041e\u0448\u0438\u0431\u043a\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438!"}),Promise.reject(e.response)}));var $=R,G=function(e){var t=e.onSuccess,c=void 0===t?function(){}:t,n=e.url,r=e.successMessage,s=e.errorMessage,i=Object(a.useState)(!1),o=Object(j.a)(i,2),u=o[0],l=o[1],d=Object(a.useState)(!1),b=Object(j.a)(d,2),m=b[0],O=b[1];return Object(M.jsx)(H.a,{title:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c?",placement:"topRight",visible:u,onConfirm:function(){O(!0),$.delete(n).then((function(){z.a.success({message:r}),c()})).catch((function(e){z.a.error({message:s}),console.error(e)})).finally((function(){O(!1),l(!1)}))},okText:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",cancelText:"\u041e\u0442\u043c\u0435\u043d\u0430",okButtonProps:{loading:m,danger:!0},onCancel:function(){l(!1)},children:Object(M.jsx)(F.a,{size:"small",danger:!0,onClick:function(){l(!0)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})})},Q=function(e){var t=e.orders,c=e.loading,n=e.showCustomer,r=void 0===n||n,s=e.fetchOrders,i=k(),o=Object(j.a)(i,1)[0],l=Object(d.f)(),b=[{title:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430",dataIndex:"id"},{title:"\u0414\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438",dataIndex:"createdAt",render:function(e){return _()(e).format("D MMMM YYYY, HH:mm")}},{title:"\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u0437\u0430\u043a\u0430\u0437\u0430",dataIndex:"products",render:function(e){return e&&!!e.length&&e.map((function(e){return Object(M.jsxs)(a.Fragment,{children:["".concat(e.name," (").concat(e.unit," x ").concat(e.order_product.quantity.replace(/\.0+$/,""),")"),Object(M.jsx)("br",{})]},e.id)}))}},{title:"\u041a \u043e\u043f\u043b\u0430\u0442\u0435",dataIndex:"products",render:function(e,t){var c=t.totalAmount||(e||[]).reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+(t.order_product.quantity*t.price||0)}),0);return e&&!!e.length&&"".concat(String(c).replace(/\.0+$/,"")," BYN")}}].concat(Object(D.a)(r?[{title:"\u0417\u0430\u043a\u0430\u0437\u0447\u0438\u043a",dataIndex:"customer",render:function(e){return Object(M.jsxs)(u.b,{to:"/customers/".concat(e.id),children:[e.name," +375",e.phoneNumber]})}}]:[]),[{title:"\u0421\u0442\u0430\u0442\u0443\u0441",dataIndex:"orderStatus",render:function(e){return Object(M.jsx)(U,{id:e.id,name:e.name})}},{title:"\u041e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439",dataIndex:"user",render:function(e){return e&&"".concat(e.fullName||"").concat(e.fullName&&e.username?", ":"").concat(e.username)}},{title:"",key:"action",render:function(e,t){return Object(M.jsxs)(J.b,{size:"middle",children:[Object(M.jsx)(G,{url:"/orders/".concat(t.id),onSuccess:s,successMessage:"\u0417\u0430\u043a\u0430\u0437 \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0451\u043d",errorMessage:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"}),Object(M.jsx)(u.b,{to:"/orders/".concat(t.id,"/edit"),children:Object(M.jsx)(F.a,{type:"primary",ghost:!0,size:"small",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),Object(M.jsx)(u.b,{to:"/orders/".concat(t.id),children:Object(M.jsx)(F.a,{size:"small",children:"\u0414\u0435\u0442\u0430\u043b\u0438"})}),1===t.orderStatusId&&!t.userId&&Object(M.jsx)(F.a,{size:"small",type:"primary",onClick:function(){var e;e=t.id,$.put("/orders/".concat(e),{orderStatusId:2,userId:o.id}).then((function(){z.a.success({message:"\u0417\u0430\u043a\u0430\u0437 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043f\u0440\u0438\u043d\u044f\u0442 \u0432\u0430\u043c\u0438"}),l.push("/orders/".concat(e))})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043f\u0440\u0438\u043d\u044f\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})}))},children:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c"})]})}}]);return Object(M.jsx)(B.a,{columns:b,dataSource:t,rowKey:"id",loading:c,pagination:!1})},X=function(e){localStorage.setItem("ordersParams",JSON.stringify(e))},Z=function(){var e=Object(a.useState)(!1),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(a.useState)([]),s=Object(j.a)(r,2),i=s[0],o=s[1],l=Object(a.useState)(function(){var e=localStorage.getItem("ordersParams");return e?JSON.parse(e):{page:1,size:10,filter:{},order:'[["createdAt", "DESC"]]'}}()),d=Object(j.a)(l,2),b=d[0],m=d[1],O=Object(a.useState)([]),h=Object(j.a)(O,2),f=h[0],p=h[1],x=Object(a.useState)(!1),g=Object(j.a)(x,2),v=g[0],I=g[1],S=Object(a.useState)([]),N=Object(j.a)(S,2),w=N[0],k=N[1],C=Object(a.useState)(!1),q=Object(j.a)(C,2),E=q[0],D=q[1],J=function(e){X(Object(y.a)(Object(y.a)({},b),e)),m((function(t){return Object(y.a)(Object(y.a)({},t),e)}))},B=Object(V.a)((function(e){X(Object(y.a)(Object(y.a)({},b),{},{page:1,size:10,filter:Object(y.a)(Object(y.a)({},b.filter),e)})),m((function(t){return Object(y.a)(Object(y.a)({},t),{},{page:1,size:10,filter:Object(y.a)(Object(y.a)({},t.filter),e)})}))}),500),P=Object(a.useCallback)((function(){n(!0),$.get("/orders",{params:b}).then((function(e){o(e.data)})).catch((function(e){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437\u044b"})})).finally((function(){n(!1)}))}),[n,o,b]);return Object(a.useEffect)((function(){P()}),[P]),Object(a.useEffect)((function(){var e=setInterval((function(){P()}),6e4);return function(){clearInterval(e)}}),[P]),Object(a.useEffect)((function(){I(!0),$.get("/order_statuses").then((function(e){p(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441\u044b"})})).finally((function(){I(!1)})),D(!0),$.get("/users").then((function(e){k(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u044e\u0437\u0435\u0440\u043e\u0432"})})).finally((function(){D(!1)}))}),[]),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{className:"table-controls",children:Object(M.jsx)(u.b,{to:"/orders/new",children:Object(M.jsx)(F.a,{className:"green-button",type:"primary",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})})}),Object(M.jsxs)("div",{className:"table-filters",children:["\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c:",Object(M.jsxs)(A.a,{style:{width:300},allowClear:!0,loading:E,value:b.order,onChange:function(e){return J({order:e})},defaultValue:'[["createdAt", "DESC"]]',children:[Object(M.jsx)(A.a.Option,{value:'[["createdAt", "DESC"]]',children:"\u043f\u043e \u0434\u0430\u0442\u0435 (\u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u043d\u043e\u0432\u044b\u0435)"}),Object(M.jsx)(A.a.Option,{value:'[["createdAt", "ASC"]]',children:"\u043f\u043e \u0434\u0430\u0442\u0435 (\u0441\u043d\u0430\u0447\u0430\u043b\u0430 \u0441\u0442\u0430\u0440\u044b\u0435)"})]})," ",Object(M.jsx)(A.a,{placeholder:"\u0421\u0442\u0430\u0442\u0443\u0441",style:{width:300},allowClear:!0,loading:v,value:b.filter.orderStatusId,onChange:function(e){return B({orderStatusId:e})},children:f.map((function(e){return Object(M.jsx)(A.a.Option,{value:e.id,children:e.name},e.id)}))})," ",Object(M.jsxs)(A.a,{placeholder:"\u041e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439",style:{width:300},allowClear:!0,value:b.filter.userId,loading:E,onChange:function(e){return B({userId:e})},children:[w.map((function(e){return Object(M.jsxs)(A.a.Option,{value:e.id,children:[e.fullName," ",e.fullName&&e.username?",":null," ",e.username]},e.id)})),Object(M.jsx)(A.a.Option,{value:null,children:"\u041d\u0438\u043a\u0442\u043e"})]})," ",Object(M.jsx)(Y.a,{style:{width:300},onChange:function(e){return B({id:e.target.value||void 0})},placeholder:"\u041f\u043e\u0438\u0441\u043a \u043f\u043e \u043d\u043e\u043c\u0435\u0440\u0443 \u0437\u0430\u043a\u0430\u0437\u0430"}),Object(M.jsx)(F.a,{onClick:function(){J({page:1,size:10,filter:{},order:'[["createdAt", "DESC"]]'})},children:"\u0421\u0431\u0440\u043e\u0441\u0438\u0442\u044c \u0444\u0438\u043b\u044c\u0442\u0440\u044b"})]}),Object(M.jsx)(Q,{orders:i.data,loading:c,fetchOrders:P}),Object(M.jsx)("div",{className:"pagination",children:Object(M.jsx)(T.a,{showSizeChanger:!1,total:i.totalItems,current:b.page,defaultPageSize:b.size,onChange:function(e){J({page:e})}})})]})},ee=(c(1096),{admin:"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440",manager:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440"}),te=function(){var e=Object(a.useState)(!1),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(a.useState)([]),s=Object(j.a)(r,2),i=s[0],o=s[1],d=Object(l.c)(N),b=Object(a.useCallback)((function(){n(!0),$.get("/users").then((function(e){o(e.data)})).catch((function(e){})).finally((function(){n(!1)}))}),[n,o]),m=Object(a.useMemo)((function(){return[{title:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",dataIndex:"username",key:"username"},{title:"\u0424\u0418\u041e",dataIndex:"fullName",key:"fullName"},{title:"Email",dataIndex:"email",key:"email"},{title:"\u0420\u043e\u043b\u044c",dataIndex:["role","name"],key:"role",render:function(e){return Object(M.jsx)(K.a,{color:"admin"===e?"geekblue":"green",children:ee[e]})}},{title:"",key:"action",render:function(e,t){return Object(M.jsxs)(J.b,{size:"middle",children:[Object(M.jsx)(u.b,{to:t.id===d.id?"/profile":"/users/".concat(t.id),children:Object(M.jsx)(F.a,{size:"small",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),t.id!==d.id&&Object(M.jsx)(G,{url:"/users/".concat(t.id),onSuccess:b,successMessage:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c ".concat(t.username," \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0451\u043d"),errorMessage:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})]})}}]}),[d,b]);return Object(a.useEffect)((function(){b()}),[b]),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{className:"table-controls",children:Object(M.jsx)(u.b,{to:"/users/new",children:Object(M.jsx)(F.a,{className:"green-button",type:"primary",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})}),Object(M.jsx)(B.a,{columns:m,dataSource:i,rowKey:"id",loading:c,pagination:!1})]})},ce=c(1390),ae=c(213),ne=c(1398),re=A.a.Option,se={labelCol:{xs:{span:16},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:8}}},ie={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},oe=function(e){var t=e.user,c=void 0===t?{}:t,n=e.onSuccess,r=ce.a.useForm(),s=Object(j.a)(r,1)[0],i=k(),o=Object(j.a)(i,3)[2],u=Object(a.useState)(!1),l=Object(j.a)(u,2),d=l[0],b=l[1],m=Object(a.useState)(!1),O=Object(j.a)(m,2),h=O[0],f=O[1],p=!!c.id;return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(ce.a,Object(y.a)(Object(y.a)({},se),{},{form:s,name:"user",onFinish:function(e){b(!0);var t={username:e.username,email:e.email,fullName:e.fullName};p&&h&&(t.password=e.password),e.roleId&&(t.roleId=Number(e.roleId)),(p?$.put("/users/".concat(c.id),t):$.post("/auth/signup",Object(y.a)(Object(y.a)({},t),{},{password:e.password}))).then((function(e){z.a.success({message:p?"\u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ".concat(e.data.username," \u0431\u044b\u043b\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b"):"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ".concat(e.data.username," \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e")}),n&&n(e.data)}),(function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})})).finally((function(){b(!1)}))},initialValues:p?Object(y.a)(Object(y.a)({},c),{},{roleId:String(c.role.id)}):{roleId:"2"},scrollToFirstError:!0,children:[Object(M.jsx)(ce.a.Item,{name:"username",label:Object(M.jsxs)("span",{children:["\u041b\u043e\u0433\u0438\u043d\xa0",Object(M.jsx)(ae.a,{title:"\u041b\u043e\u0433\u0438\u043d \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0439 \u0434\u043b\u044f \u0432\u0445\u043e\u0434\u0430",children:Object(M.jsx)(ne.a,{})})]}),rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d",whitespace:!0}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:"email",label:"E-mail",rules:[{type:"email",message:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 E-mail"},{required:!0,message:"\u0412\u0435\u0434\u0438\u0442\u0435 E-mail"}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:"fullName",label:"\u0424\u0418\u041e",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0424\u0418\u041e",whitespace:!0}],children:Object(M.jsx)(Y.a,{})}),o&&Object(M.jsx)(ce.a.Item,{name:"roleId",label:"\u0420\u043e\u043b\u044c",rules:[{required:!0,message:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0440\u043e\u043b\u044c!"}],children:Object(M.jsxs)(A.a,{children:[Object(M.jsx)(re,{value:"1",children:"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440"}),Object(M.jsx)(re,{value:"2",children:"\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440"})]})}),p&&Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},ie),{},{children:Object(M.jsx)(F.a,{onClick:function(){f((function(e){return!e}))},children:h?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u0421\u043c\u0435\u043d\u0438\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c"})})),(!p||h)&&Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(ce.a.Item,{name:"password",label:"\u041d\u043e\u0432\u044b\u0439 \u043f\u0430\u0440\u043e\u043b\u044c",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"}],hasFeedback:!0,children:Object(M.jsx)(Y.a.Password,{autoComplete:"new-password"})}),Object(M.jsx)(ce.a.Item,{name:"confirm",label:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u0435 \u043f\u0430\u0440\u043e\u043b\u044f",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"},function(e){var t=e.getFieldValue;return{validator:function(e,c){return c&&t("password")!==c?Promise.reject("\u041f\u0430\u0440\u043e\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u0442\u044c"):Promise.resolve()}}}],children:Object(M.jsx)(Y.a.Password,{})})]}),Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},ie),{},{children:Object(M.jsx)(F.a,{type:"primary",htmlType:"submit",loading:d,children:p?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})}))]}))})},ue=function(){var e=k(),t=Object(j.a)(e,2),c=t[0],a=t[1];return Object(M.jsx)(oe,{user:c,onSuccess:function(e){a(e)}})},le=c(723),de=(c(1101),function(e){return Object(M.jsx)("div",{className:"spinner",children:Object(M.jsx)(le.a,Object(y.a)({},e))})}),je=function(){var e=Object(a.useState)(),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(d.h)().id,s=Object(d.f)();return Object(a.useEffect)((function(){$.get("/users/".concat(r)).then((function(e){n(e.data)})).catch((function(e){console.log(e)}))}),[n,r]),c?Object(M.jsx)(oe,{user:c,onSuccess:function(){s.push("/users")}}):Object(M.jsx)(de,{size:"large"})},be=function(){var e=Object(d.f)();return Object(M.jsx)(oe,{onSuccess:function(){e.push("/users")}})},me=c(1384),Oe=c(1385),he=c(431),fe=c(412),pe=c(1401),xe=c(1400),ge={labelCol:{xs:{span:16},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:8}}},ye={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},ve=c(216),Ie=c(1393),Se=c(1399),Ne=function(e,t){var c=Object(a.useRef)(!1);Object(a.useEffect)((function(){c.current?e():c.current=!0}),t)},we=(c(580),function(e){var t=e.value,c=void 0===t?"{}":t,a=e.onChange,n=e.productId,r=("string"===typeof c?JSON.parse(c):c)||{},s={title:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0435\u0434\u0438\u043d\u0438\u0446 \u0442\u043e\u0432\u0430\u0440\u0430",values:[1]};return Ne((function(){a("{}")}),[n]),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{className:"packing-label",children:s.title}),Object(M.jsx)("div",{className:"packing-wrapper",children:s.values.map((function(e){return Object(M.jsx)("div",{className:"packing-input-wrapper",children:Object(M.jsxs)("div",{className:"packing-input",children:[Object(M.jsx)(Se.a,{style:{fontSize:20},onClick:function(){a(JSON.stringify(Object(y.a)(Object(y.a)({},r),{},Object(ve.a)({},e,(r[e]||1)-1))))}}),Object(M.jsx)(Ie.a,{keyboard:!1,onChange:function(t){a(JSON.stringify(Object(y.a)(Object(y.a)({},r),{},Object(ve.a)({},e,t))))},value:r[e]||0,min:0}),Object(M.jsx)(xe.a,{style:{fontSize:20},onClick:function(){a(JSON.stringify(Object(y.a)(Object(y.a)({},r),{},Object(ve.a)({},e,(r[e]||0)+1))))}})]})},e)}))})]})}),ke=function(e){var t=e.value,c=e.onChange,n=e.form,r=e.fieldName,s=e.products,i=n.getFieldValue(["products",r,"packing"]),o=n.getFieldValue(["products",r,"id"]),u=(s.find((function(e){return e.id===o}))||{}).price*t||0;return Object(a.useEffect)((function(){c(function(e){if(e){var t="string"===typeof e?JSON.parse(e):e;return Object.keys(t).reduce((function(e,c){return e+t[c]*Number(c)}),0)}}(i))}),[i]),Object(M.jsx)("div",{className:"packing-quantity",children:Object(M.jsx)("div",{children:u?"".concat(u," BYN"):null})})},Fe=A.a.Option,Ce=function(e){var t=e.form,c=e.products,a=e.productsLoading;return Object(M.jsx)(ce.a.List,{name:"products",children:function(e,n){var r=n.add,s=n.remove;return Object(M.jsxs)(M.Fragment,{children:[e.map((function(e){return Object(M.jsxs)("div",{className:"product-item",children:[Object(M.jsxs)(me.a,{gutter:24,align:"middle",children:[Object(M.jsx)(Oe.a,{xs:16,children:Object(M.jsx)(ce.a.Item,{noStyle:!0,shouldUpdate:!0,children:function(){var n=(t.getFieldValue("products")||[]).filter((function(e){return e&&e.id})).map((function(e){return e.id})),r=t.getFieldValue(["products",e.key,"id"]),s=c.find((function(e){return e.id===r}));return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},e),{},{label:"\u0422\u043e\u0432\u0430\u0440",name:[e.name,"id"],fieldKey:[e.fieldKey,"id"],rules:[{required:!0,message:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0442\u043e\u0432\u0430\u0440"}],children:Object(M.jsx)(A.a,{disabled:a,children:c.map((function(e){return Object(M.jsx)(Fe,{disabled:n.includes(e.id),value:e.id,children:"".concat(e.name," (").concat(e.price," BYN \u0437\u0430 ").concat(e.unit,")")},e.id)}))})})),s&&s.description&&Object(M.jsx)("i",{style:{color:"gray"},children:s.description})]})}})}),Object(M.jsx)(Oe.a,{xs:1,children:Object(M.jsxs)(F.a,{type:"text",danger:!0,onClick:function(){return s(e.name)},children:[Object(M.jsx)(pe.a,{twoToneColor:"red"}),"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"]})})]}),Object(M.jsx)(ce.a.Item,{noStyle:!0,shouldUpdate:!0,children:function(){var c=t.getFieldValue(["products",e.key,"id"]);return c?Object(M.jsx)(me.a,{children:Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},e),{},{name:[e.name,"packing"],fieldKey:[e.fieldKey,"packing"],label:"\u0424\u0430\u0441\u043e\u0432\u043a\u0430",noStyle:!0,children:Object(M.jsx)(we,{productId:c})}))}):null}}),Object(M.jsx)(me.a,{children:Object(M.jsx)(ce.a.Item,{shouldUpdate:!0,children:function(){return Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},e),{},{name:[e.name,"quantity"],fieldKey:[e.fieldKey,"quantity"],noStyle:!0,children:Object(M.jsx)(ke,{form:t,fieldName:e.name,products:c})}))}})})]},e.key)})),Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},ye),{},{children:Object(M.jsx)(F.a,{type:"dashed",onClick:function(){return r()},icon:Object(M.jsx)(xe.a,{}),children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440"})}))]})}})},Me=function(e){var t=e.validatePhone;return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(ce.a.Item,{name:["customer","name"],label:"\u0418\u043c\u044f",rules:[{required:!0,message:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0438\u043c\u044f"}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:["customer","phoneNumber"],label:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 (\u043c\u043e\u0431\u0438\u043b\u044c\u043d\u044b\u0439)",rules:[Object(y.a)({required:!0,message:"\u041d\u043e\u043c\u0435\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0441\u043e\u0441\u0442\u043e\u044f\u0442\u044c \u0438\u0437 9 \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0445 \u043f\u043e\u0441\u043b\u0435 \u043a\u043e\u0434\u0430"},t?{len:9}:{})],normalize:function(e){return e.replace(/\D/g,"")},children:Object(M.jsx)(Y.a,{addonBefore:"+375",style:{width:"100%"}})}),Object(M.jsx)(ce.a.Item,{name:["customer","email"],label:"Email",rules:[{type:"email",message:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 E-mail"},{required:!0,message:"\u0412\u0435\u0434\u0438\u0442\u0435 E-mail",whitespace:!0}],children:Object(M.jsx)(Y.a,{})})]})},qe=c(1389),Ee=function(e){var t=e.form,c=t.getFieldValue("products")||[],n=t.getFieldValue("deliveryMethodId"),r=c.reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+(t.quantity||0)}),0)>=10;return Object(a.useEffect)((function(){3!==n||r||t.setFieldsValue({deliveryMethodId:1})}),[n,r]),Object(M.jsx)(ce.a.Item,{name:"deliveryMethodId",label:"\u0421\u043f\u043e\u0441\u043e\u0431 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438",rules:[{required:!0,message:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u043f\u043e\u0441\u043e\u0431 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438"}],children:Object(M.jsxs)(A.a,{children:[Object(M.jsx)(A.a.Option,{value:1,children:"\u0421\u0430\u043c\u043e\u0432\u044b\u0432\u043e\u0437 (16:00-22:00 \u0433. \u041c\u0438\u043d\u0441\u043a, \u0443\u043b. \u0418\u043b\u044c\u044f\u043d\u0441\u043a\u0430\u044f 4)"}),Object(M.jsxs)(A.a.Option,{disabled:!r,value:3,children:["\u042f\u043d\u0434\u0435\u043a\u0441 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430 \u0437\u0430 \u0441\u0447\u0435\u0442 \u043f\u0440\u043e\u0434\u0430\u0432\u0446\u0430 ",!r&&"(\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e \u043f\u0440\u0438 \u0437\u0430\u043a\u0430\u0437\u0430 \u043e\u0442 10 \u043a\u0433)"]})]})})},ze=function(e){var t=e.form;return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(ce.a.Item,{noStyle:!0,shouldUpdate:!0,children:function(){return Object(M.jsx)(Ee,{form:t})}}),Object(M.jsx)(ce.a.Item,{dependencies:["deliveryMethodId"],noStyle:!0,children:function(){var e=t.getFieldValue("deliveryMethodId");return(2===e||3===e)&&Object(M.jsx)(ce.a.Item,{name:"deliveryAddress",label:"\u0410\u0434\u0440\u0435\u0441 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0430\u0434\u0440\u0435\u0441",whitespace:!0}],children:Object(M.jsx)(Y.a,{})})}}),Object(M.jsx)(ce.a.Item,{name:"deliveryDate",label:"\u0414\u0430\u0442\u0430 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438",rules:[{required:!0,message:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0434\u0430\u0442\u0443 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438"}],children:Object(M.jsx)(qe.a,{format:"DD.MM.YYYY",disabledDate:function(e){return!!e&&(!!e.isBefore(_()("2022-07-05"))||!e.isSame(new Date,"day")&&e<_()().endOf("day"))}})}),Object(M.jsx)(ce.a.Item,{name:"paymentMethod",label:"\u0421\u043f\u043e\u0441\u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u044b",rules:[{required:!0,message:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u043f\u043e\u0441\u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u044b"}],children:Object(M.jsxs)(he.a.Group,{children:[Object(M.jsx)(he.a,{value:"\u041d\u0430\u043b\u0438\u0447\u043d\u044b\u0435",children:"\u041d\u0430\u043b\u0438\u0447\u043d\u044b\u0435"}),Object(M.jsx)(he.a,{value:"\u041a\u0430\u0440\u0442\u0430",children:"\u041a\u0430\u0440\u0442\u0430"})]})})]})},Ae=A.a.Option,Ye={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},Te=function(e){var t=e.order,c=void 0===t?{}:t,n=e.onSuccess,r=ce.a.useForm(),s=Object(j.a)(r,1)[0],i=Object(a.useState)({data:[]}),o=Object(j.a)(i,2),l=o[0],d=o[1],b=Object(a.useState)(!1),m=Object(j.a)(b,2),O=m[0],h=m[1],f=Object(a.useState)([]),p=Object(j.a)(f,2),x=p[0],g=p[1],v=Object(a.useState)(!1),I=Object(j.a)(v,2),S=I[0],N=I[1],w=Object(a.useState)([]),C=Object(j.a)(w,2),q=C[0],E=C[1],T=Object(a.useState)(!1),V=Object(j.a)(T,2),D=V[0],J=V[1],B=Object(a.useState)(!1),P=Object(j.a)(B,2),K=P[0],W=P[1],U=Object(a.useState)(1),H=Object(j.a)(U,2),L=H[0],R=H[1],G=k(),Q=Object(j.a)(G,1)[0],X=!!c.id,Z=Object(a.useState)([]),ee=Object(j.a)(Z,2),te=ee[0],ae=ee[1],ne=Object(a.useState)(!1),re=Object(j.a)(ne,2),se=re[0],ie=re[1];Object(a.useEffect)((function(){ie(!0),$.get("/products").then((function(e){ae(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u044b"})})).finally((function(){ie(!1)}))}),[ae,ie]);var oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";h(!0),$.get("/customers",{params:{page:1,size:10,search:e}}).then((function(e){d(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u043e\u0432"})})).finally((function(){h(!1)}))};Object(a.useEffect)((function(){X&&s.resetFields()}),[s,X,c]),Object(a.useEffect)((function(){oe(),N(!0),$.get("/order_statuses").then((function(e){g(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441\u044b"})})).finally((function(){N(!1)})),J(!0),$.get("/users").then((function(e){E(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u044e\u0437\u0435\u0440\u043e\u0432"})})).finally((function(){J(!1)}))}),[d,h]);var ue=(c.products||[]).map((function(e){return{id:e.id,quantity:e.order_product.quantity,packing:e.order_product.packing}}));return Object(M.jsxs)(M.Fragment,{children:[X&&Object(M.jsx)("div",{className:"table-controls",children:Object(M.jsx)(u.b,{to:"/orders/".concat(c.id),children:Object(M.jsx)(F.a,{type:"primary",children:"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440"})})}),Object(M.jsxs)(ce.a,{layout:"vertical",form:s,name:"order",onFinish:function(e){var t=[];if(X){var a=e.products.map((function(e){return e.id})),r=ue.reduce((function(e,t){return a.includes(t.id)||e.push(Object(y.a)(Object(y.a)({},t),{},{_destroy:!0})),e}),[]);e.products=e.products.concat(r)}X||e.products&&e.products.length?e.products.some((function(e){return!e.quantity}))&&t.push("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u0430"):t.push("\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u044b \u0442\u043e\u0432\u0430\u0440\u044b"),t.length?z.a.error({message:t.join(". ")}):(W(!0),(X?$.put("/orders/".concat(c.id),e):$.post("/orders",e)).then((function(e){z.a.success({message:X?"\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u044b":"\u0417\u0430\u043a\u0430\u0437 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d"}),n&&n(e.data)}),(function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u043a\u0430\u0437\u0430"})})).finally((function(){W(!1)})))},initialValues:X?{deliveryMethodId:c.deliveryMethodId,deliveryAddress:c.deliveryAddress,deliveryDate:_()(c.deliveryDate),paymentMethod:c.paymentMethod,deliveryTime:c.deliveryTime,name:c.name,notes:c.notes,orderStatusId:c.orderStatusId,userId:c.userId,products:ue,totalAmount:String(c.totalAmount||c.products.reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+(t.order_product.quantity*t.price||0)}),0)).replace(/\.0+$/,"")}:{deliveryMethodId:1,orderStatusId:1,paymentMethod:"\u041d\u0430\u043b\u0438\u0447\u043d\u044b\u0435",products:[{id:null,quantity:1}]},scrollToFirstError:!0,style:{maxWidth:750,margin:"0 auto"},onValuesChange:function(e,t){if(e.products&&te.length){var c=t.products.reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=te.find((function(e){return e.id===t.id}))||{};return e+(t.quantity*c.price||0)}),0);s.setFieldsValue({totalAmount:c})}},children:[Object(M.jsx)(Ce,{form:s,products:te,productsLoading:se}),Object(M.jsxs)("div",{style:{marginBottom:"50px"},children:[Object(M.jsx)(ze,{form:s}),Object(M.jsx)(ce.a.Item,{name:"notes",label:"\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0438 \u043f\u043e\u0436\u0435\u043b\u0430\u043d\u0438\u044f",children:Object(M.jsx)(Y.a.TextArea,{})}),Object(M.jsx)(ce.a.Item,{name:"orderStatusId",label:"\u0421\u0442\u0430\u0442\u0443\u0441",rules:[{required:!0,message:"\u0423\u043a\u0430\u0436\u0438\u0442\u0435 \u0441\u0442\u0430\u0442\u0443\u0441"}],children:Object(M.jsx)(A.a,{loading:S,children:x.map((function(e){return Object(M.jsx)(Ae,{value:e.id,children:e.name},e.id)}))})}),Object(M.jsx)(ce.a.Item,{shouldUpdate:!0,label:"\u041e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439",children:function(){return Object(M.jsxs)(me.a,{gutter:24,children:[Object(M.jsx)(Oe.a,{span:18,children:Object(M.jsx)(ce.a.Item,{name:"userId",noStyle:!0,children:Object(M.jsx)(A.a,{loading:D,children:q.map((function(e){return Object(M.jsx)(Ae,{value:e.id,children:"".concat(e.fullName||""," ").concat(e.email,", ").concat(e.username)},e.id)}))})})}),s.getFieldValue("userId")===Q.id?null:Object(M.jsx)(Oe.a,{span:6,children:Object(M.jsx)(F.a,{type:"primary",onClick:function(){s.setFieldsValue({userId:Q.id})},children:"\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u043c\u0435\u043d\u044f"})})]})}})]}),X?null:Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(ce.a.Item,{label:"\u0417\u0430\u043a\u0430\u0437\u0447\u0438\u043a",children:Object(M.jsxs)(he.a.Group,{onChange:function(e){R(e.target.value)},value:L,children:[Object(M.jsx)(he.a,{value:1,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u043e\u0433\u043e \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u0430"}),Object(M.jsx)(he.a,{value:2,children:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e"})]})}),1===L?Object(M.jsx)(Me,{}):Object(M.jsx)(ce.a.Item,{name:"customerId",label:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435",rules:[{required:!0,message:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u0430"}],children:Object(M.jsx)(A.a,{showSearch:!0,loading:O,notFoundContent:O?Object(M.jsx)(le.a,{size:"small"}):null,placeholder:"\u041f\u043e\u0438\u0441\u043a",onSearch:Object(fe.a)(500,oe),filterOption:!1,children:l.data.map((function(e){return Object(M.jsx)(Ae,{value:e.id,children:"".concat(e.name,", ").concat(e.email,", ").concat(e.phoneNumber)},e.id)}))})})]}),Object(M.jsx)(ce.a.Item,{name:"totalAmount",label:"\u041a \u043e\u043f\u043b\u0430\u0442\u0435 (BYN)",children:Object(M.jsx)(Y.a,{type:"number"})}),Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},Ye),{},{children:Object(M.jsx)(F.a,{type:"primary",htmlType:"submit",loading:K,children:X?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})}))]})]})},Ve=function(){var e=Object(d.f)();return Object(M.jsx)(Te,{onSuccess:function(t){var c=t.id;e.push("/orders/".concat(c))}})},De=function(){var e=Object(a.useState)(),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(d.h)().id,s=Object(d.f)(),i=function(){$.get("/orders/".concat(r)).then((function(e){c&&JSON.stringify(c)!==JSON.stringify(e.data)&&(z.a.warning({message:"\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435! \u042d\u0442\u043e\u0442 \u0437\u0430\u043a\u0430\u0437 \u0431\u044b\u043b \u0438\u0437\u043c\u0435\u043d\u0451\u043d \u0434\u0440\u0443\u0433\u0438\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0445.",duration:0}),n(e.data)),c||n(e.data)})).catch((function(e){console.log(e)}))};return Object(a.useEffect)((function(){i()}),[r]),Object(a.useEffect)((function(){var e=setInterval((function(){i()}),6e4);return function(){clearInterval(e)}}),[r,c]),c?Object(M.jsx)(Te,{order:c,onSuccess:function(e){var t=e.id;s.push("/orders/".concat(t))}}):Object(M.jsx)(de,{size:"large"})},Je=c(1392),Be=function(){var e=Object(a.useState)(),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(d.h)().id,s=function(){$.get("/orders/".concat(r)).then((function(e){c&&JSON.stringify(c)!==JSON.stringify(e.data)&&(z.a.warning({message:"\u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435! \u042d\u0442\u043e\u0442 \u0437\u0430\u043a\u0430\u0437 \u0431\u044b\u043b \u0438\u0437\u043c\u0435\u043d\u0451\u043d \u0434\u0440\u0443\u0433\u0438\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0430\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0445.",duration:0}),n(e.data)),c||n(e.data)})).catch((function(e){console.log(e)}))};return Object(a.useEffect)((function(){s()}),[r]),Object(a.useEffect)((function(){var e=setInterval((function(){s()}),6e4);return function(){clearInterval(e)}}),[r,c]),c?Object(M.jsxs)(Je.a,{bordered:!0,title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0437\u0430\u043a\u0430\u0437\u0435",extra:Object(M.jsx)(u.b,{to:"/orders/".concat(r,"/edit"),children:Object(M.jsx)(F.a,{type:"primary",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),children:[Object(M.jsx)(Je.a.Item,{label:"\u041d\u043e\u043c\u0435\u0440 \u0437\u0430\u043a\u0430\u0437\u0430",children:c.id}),Object(M.jsx)(Je.a.Item,{label:"\u041f\u0440\u0435\u0434\u043c\u0435\u0442 \u0437\u0430\u043a\u0430\u0437\u0430",children:(c.products||[]).map((function(e){JSON.parse(e.order_product.packing||"{}");return Object(M.jsxs)(a.Fragment,{children:[e.name,": ",e.order_product.quantity.replace(/\.0+$/,"")," x ",e.unit,Object(M.jsx)("br",{})]},e.id)}))}),Object(M.jsxs)(Je.a.Item,{label:"\u041a \u043e\u043f\u043b\u0430\u0442\u0435",children:[String(c.totalAmount||(c.products||[]).reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+(t.order_product.quantity*t.price||0)}),0)).replace(/\.0+$/,"")," BYN"]}),Object(M.jsx)(Je.a.Item,{label:"\u0421\u043f\u043e\u0441\u043e\u0431 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438",children:c.deliveryMethod.name}),2===c.deliveryMethod.id&&c.deliveryAddress&&Object(M.jsx)(Je.a.Item,{label:"\u0410\u0434\u0440\u0435\u0441 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438",children:c.deliveryAddress}),Object(M.jsxs)(Je.a.Item,{label:"\u0412\u0440\u0435\u043c\u044f \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438",children:[_()(c.deliveryDate).format("D MMMM YYYY"),Object(M.jsx)("br",{}),c.deliveryTime]}),Object(M.jsx)(Je.a.Item,{label:"\u0421\u043f\u043e\u0441\u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u044b",children:c.paymentMethod}),Object(M.jsx)(Je.a.Item,{label:"\u0421\u0442\u0430\u0442\u0443\u0441",children:Object(M.jsx)(U,Object(y.a)({},c.orderStatus))}),Object(M.jsx)(Je.a.Item,{label:"\u041e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439",children:c.user?Object(M.jsxs)(M.Fragment,{children:[c.user.fullName&&Object(M.jsxs)(M.Fragment,{children:[c.user.fullName,Object(M.jsx)("br",{})]}),c.user.username,Object(M.jsx)("br",{}),c.user.email,Object(M.jsx)("br",{})]}):"\u041d\u0435 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d"}),Object(M.jsx)(Je.a.Item,{label:"\u0417\u0430\u043a\u0430\u0437\u0447\u0438\u043a",children:Object(M.jsxs)(u.b,{to:"/customers/".concat(c.customer.id),children:[c.customer.name,Object(M.jsx)("br",{}),c.customer.email,Object(M.jsx)("br",{}),"+375".concat(c.customer.phoneNumber)]})}),c.notes&&Object(M.jsx)(Je.a.Item,{label:"\u0414\u043e\u043f. \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438",children:c.notes}),Object(M.jsx)(Je.a.Item,{label:"\u0421\u043e\u0437\u0434\u0430\u043d",children:_()(c.createdAt).format("D MMMM YYYY, HH:mm")}),Object(M.jsx)(Je.a.Item,{label:"\u0418\u0441\u0442\u043e\u0440\u0438\u044f",children:c.orderStatusHistories.map((function(e){return Object(M.jsxs)(a.Fragment,{children:[Object(M.jsxs)("b",{children:[e.statusName,":"]})," ",_()(e.createdAt).format("D MMMM YYYY, HH:mm"),Object(M.jsx)("br",{})]},e.id)}))})]}):Object(M.jsx)(de,{size:"large"})},Pe=function(){var e=Object(a.useState)(!1),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(a.useState)([]),s=Object(j.a)(r,2),i=s[0],o=s[1],l=Object(a.useState)({page:1,size:10}),d=Object(j.a)(l,2),b=d[0],m=d[1],O=function(e){m((function(t){return Object(y.a)(Object(y.a)({},t),e)}))},h=Object(a.useCallback)((function(){n(!0),$.get("/customers",{params:b}).then((function(e){o(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u043e\u0432"})})).finally((function(){n(!1)}))}),[n,o,b]),f=Object(a.useMemo)((function(){return[{title:"\u0418\u043c\u044f",dataIndex:"name"},{title:"Email",dataIndex:"email"},{title:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043a\u0430\u0437\u043e\u0432",dataIndex:["orders","length"]},{title:"",key:"action",render:function(e,t){return Object(M.jsxs)(J.b,{size:"middle",children:[Object(M.jsx)(G,{url:"/customers/".concat(t.id),onSuccess:h,successMessage:"\u0417\u0430\u043a\u0430\u0437\u0447\u0438\u043a \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0451\u043d",errorMessage:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u0430"}),Object(M.jsx)(u.b,{to:"/customers/".concat(t.id,"/edit"),children:Object(M.jsx)(F.a,{size:"small",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),Object(M.jsx)(u.b,{to:"/customers/".concat(t.id),children:Object(M.jsx)(F.a,{size:"small",children:"\u0414\u0435\u0442\u0430\u043b\u0438"})})]})}}]}),[h]);Object(a.useEffect)((function(){h()}),[h]);var p=Object(fe.a)(500,(function(e){O({search:e.target.value,page:1,size:10})}));return Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{className:"table-controls",children:Object(M.jsx)(u.b,{to:"/customers/new",children:Object(M.jsx)(F.a,{className:"green-button",type:"primary",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})}),Object(M.jsx)("div",{className:"table-filters",children:Object(M.jsx)(Y.a,{style:{width:300},onChange:p,placeholder:"\u041f\u043e\u0438\u0441\u043a"})}),Object(M.jsx)(B.a,{columns:f,dataSource:i.data,rowKey:"id",loading:c,pagination:!1}),Object(M.jsx)("div",{className:"pagination",children:Object(M.jsx)(T.a,{showSizeChanger:!1,total:i.totalItems,current:b.page,defaultPageSize:b.size,onChange:function(e){O({page:e})}})})]})},_e=function(){var e=Object(a.useState)(),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(d.h)().id,s=Object(a.useCallback)((function(){$.get("/customers/".concat(r)).then((function(e){n(e.data)})).catch((function(e){console.log(e)}))}),[r,n]);return Object(a.useEffect)((function(){s()}),[s]),c?Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{style:{marginBottom:40},children:Object(M.jsxs)(Je.a,{bordered:!0,title:"\u0418\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u0435",extra:Object(M.jsx)(u.b,{to:"/customers/".concat(r,"/edit"),children:Object(M.jsx)(F.a,{type:"primary",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})}),children:[Object(M.jsx)(Je.a.Item,{label:"\u0418\u043c\u044f",children:c.name}),Object(M.jsx)(Je.a.Item,{label:"Email",children:c.email}),Object(M.jsxs)(Je.a.Item,{label:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",children:["+375",c.phoneNumber]})]})}),Object(M.jsx)("h2",{children:"\u0417\u0430\u043a\u0430\u0437\u044b"}),Object(M.jsx)(Q,{orders:c.orders,showCustomer:!1,loading:!1,fetchOrders:s})]}):Object(M.jsx)(de,{size:"large"})},Ke={labelCol:{xs:{span:16},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:8}}},We={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},Ue=function(e){var t=e.customer,c=void 0===t?{}:t,n=e.onSuccess,r=ce.a.useForm(),s=Object(j.a)(r,1)[0],i=Object(a.useState)(!1),o=Object(j.a)(i,2),u=o[0],l=o[1],d=!!c.id;return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(ce.a,Object(y.a)(Object(y.a)({},Ke),{},{form:s,name:"customer",onFinish:function(e){l(!0),(d?$.put("/customers/".concat(c.id),e):$.post("/customers",e)).then((function(e){z.a.success({message:d?"\u0414\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u0430 ".concat(e.data.organizationName," \u0431\u044b\u043b\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b"):"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u0430 ".concat(e.data.organizationName," \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e")}),n&&n(e.data)}),(function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0437\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u0430"})})).finally((function(){l(!1)}))},initialValues:d?{email:c.email,organizationName:c.organizationName,address:c.address,bankAccountNumber:c.bankAccountNumber,bankName:c.bankName,payerAccountNumber:c.payerAccountNumber}:{},scrollToFirstError:!0,children:[Object(M.jsx)(ce.a.Item,{name:"email",label:"Email",rules:[{type:"email",message:"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u044c\u043d\u044b\u0439 E-mail"},{required:!0,message:"\u0412\u0435\u0434\u0438\u0442\u0435 E-mail",whitespace:!0}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:"organizationName",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438",rules:[{required:!0,message:"\u0412\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438",whitespace:!0}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:"address",label:"\u042e\u0440\u0438\u0434\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0430\u0434\u0440\u0435\u0441",rules:[{required:!0,message:"\u0412\u0435\u0434\u0438\u0442\u0435 \u044e\u0440\u0438\u0434\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0430\u0434\u0440\u0435\u0441",whitespace:!0}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:"bankAccountNumber",label:"\u041d\u043e\u043c\u0435\u0440 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u0441\u0447\u0451\u0442\u0430",rules:[{required:!0,message:"\u0412\u0435\u0434\u0438\u0442\u0435 \u043d\u043e\u043c\u0435\u0440 \u0431\u0430\u043d\u043a\u043e\u0432\u0441\u043a\u043e\u0433\u043e \u0441\u0447\u0451\u0442\u0430",whitespace:!0}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:"bankName",label:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0431\u0430\u043d\u043a\u0430",rules:[{required:!0,message:"\u0412\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0431\u0430\u043d\u043a\u0430",whitespace:!0}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:"payerAccountNumber",label:"\u0423\u041d\u041f",rules:[{required:!0,message:"\u0412\u0435\u0434\u0438\u0442\u0435 \u0423\u041d\u041f (9 \u0446\u0438\u0444\u0440)"}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},We),{},{children:Object(M.jsx)(F.a,{type:"primary",htmlType:"submit",loading:u,children:d?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})}))]}))})},He=function(){var e=Object(a.useState)(),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(d.h)().id,s=Object(d.f)();return Object(a.useEffect)((function(){$.get("/customers/".concat(r)).then((function(e){n(e.data)})).catch((function(e){console.log(e)}))}),[r]),c?Object(M.jsx)(Ue,{customer:c,onSuccess:function(e){var t=e.id;s.push("/customers/".concat(t))}}):Object(M.jsx)(de,{size:"large"})},Le=function(){var e=Object(d.f)();return Object(M.jsx)(Ue,{onSuccess:function(t){var c=t.id;e.push("/customers/".concat(c))}})},Re=function(){var e=Object(a.useState)(!1),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(a.useState)([]),s=Object(j.a)(r,2),i=s[0],o=s[1],l=Object(a.useCallback)((function(){n(!0),$.get("/products").then((function(e){o(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440\u044b"})})).finally((function(){n(!1)}))}),[n,o]),d=Object(a.useMemo)((function(){return[{title:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",dataIndex:"name"},{title:"\u0415\u0434\u0438\u043d\u0438\u0446\u0430",dataIndex:"unit"},{title:"\u0412\u0435\u0441 \u0435\u0434\u0438\u043d\u0438\u0446\u044b",dataIndex:"unitWeight"},{title:"\u0426\u0435\u043d\u0430 \u0437\u0430 \u0435\u0434\u0438\u043d\u0438\u0446\u0443 (\u0440\u0443\u0431)",dataIndex:"price"},{title:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",dataIndex:"description"},{title:"",key:"action",render:function(e,t){return Object(M.jsxs)(J.b,{size:"middle",children:[Object(M.jsx)(G,{url:"/products/".concat(t.id),onSuccess:l,successMessage:"\u0422\u043e\u0432\u0430\u0440 \u0431\u044b\u043b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0443\u0434\u0430\u043b\u0451\u043d",errorMessage:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440"}),Object(M.jsx)(u.b,{to:"/products/".concat(t.id,"/edit"),children:Object(M.jsx)(F.a,{size:"small",children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})})]})}}]}),[l]);return Object(a.useEffect)((function(){l()}),[l]),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("div",{className:"table-controls",children:Object(M.jsx)(u.b,{to:"/products/new",children:Object(M.jsx)(F.a,{className:"green-button",type:"primary",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})}),Object(M.jsx)(B.a,{columns:d,dataSource:i,rowKey:"id",loading:c,pagination:!1})]})},$e=function(e){var t=e.product,c=void 0===t?{}:t,n=e.onSuccess,r=ce.a.useForm(),s=Object(j.a)(r,1)[0],i=Object(a.useState)(!1),o=Object(j.a)(i,2),u=o[0],l=o[1],d=!!c.id;return Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(ce.a,Object(y.a)(Object(y.a)({},ge),{},{form:s,name:"product",onFinish:function(e){l(!0),(d?$.put("/products/".concat(c.id),e):$.post("/products",e)).then((function(e){z.a.success({message:d?"\u0414\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u0430 ".concat(e.data.name," \u0431\u044b\u043b\u0438 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u044b"):"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430 ".concat(e.data.name," \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e")}),n&&n(e.data)}),(function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u043e\u0432\u0430\u0440\u0430"})})).finally((function(){l(!1)}))},initialValues:d?{name:c.name,description:c.description}:{},scrollToFirstError:!0,children:[Object(M.jsx)(ce.a.Item,{name:"name",label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",rules:[{required:!0,message:"\u0412\u0435\u0434\u0438\u0442\u0435 \u043d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",whitespace:!0}],children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:"unit",label:"\u0415\u0434\u0438\u043d\u0438\u0446\u0430",children:Object(M.jsx)(Y.a,{})}),Object(M.jsx)(ce.a.Item,{name:"unitWeight",label:"\u0412\u0435\u0441 \u0435\u0434\u0438\u043d\u0438\u0446\u044b (\u043a\u0433)",children:Object(M.jsx)(Y.a,{type:"number"})}),Object(M.jsx)(ce.a.Item,{name:"price",label:"\u0426\u0435\u043d\u0430 \u0437\u0430 \u0435\u0434\u0438\u043d\u0438\u0446\u0443 (\u0440\u0443\u0431)",children:Object(M.jsx)(Y.a,{type:"number"})}),Object(M.jsx)(ce.a.Item,{name:"description",label:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",children:Object(M.jsx)(Y.a.TextArea,{})}),Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},ye),{},{children:Object(M.jsx)(F.a,{type:"primary",htmlType:"submit",loading:u,children:d?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"})}))]}))})},Ge=function(){var e=Object(d.f)();return Object(M.jsx)($e,{onSuccess:function(){e.push("/products")}})},Qe=function(){var e=Object(a.useState)(),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(d.h)().id,s=Object(d.f)();return Object(a.useEffect)((function(){$.get("/products/".concat(r)).then((function(e){n(e.data)})).catch((function(e){console.log(e)}))}),[r]),c?Object(M.jsx)($e,{product:c,onSuccess:function(){s.push("/products")}}):Object(M.jsx)(de,{size:"large"})},Xe=c(743),Ze=c(1387),et=function(){return new Date((new Date).getTime()-60*(new Date).getTimezoneOffset()*1e3).toISOString().split("T").shift()},tt=function(){var e=localStorage.getItem("stats:createdAtStart");return e?JSON.stringify([e,et()]):null},ct=function(e){if(!e)return null;var t=JSON.parse(e),c=Object(j.a)(t,2),a=c[0],n=c[1];return a&&n?[_()(a),_()(n)]:null},at=function(){var e=Object(a.useState)({data:[]}),t=Object(j.a)(e,2),c=t[0],n=t[1],r=Object(a.useState)(),s=Object(j.a)(r,2),i=s[0],o=s[1],u=Object(a.useState)({page:1,size:1e4,createdAt:tt()}),l=Object(j.a)(u,2),d=l[0],b=l[1];Object(a.useEffect)((function(){if(d.createdAt){var e=JSON.parse(d.createdAt),t=Object(j.a)(e,1)[0];t&&localStorage.setItem("stats:createdAtStart",t)}}),[d.createdAt]);var m=c.data.reduce((function(e,t){return e.concat(t.products.map((function(e){return Object(y.a)(Object(y.a)({},e),{},{orderStatusId:t.orderStatusId,orderStatusName:t.orderStatus.name})})))}),[]),O=Object(Ze.a)(m,"name"),h=Object(Ze.a)(c.data,"orderStatus.name"),f=0,p=Object.keys(h).map((function(e){var t=h[e],c=t.reduce((function(e,t){var c=t.totalAmount||t.products.reduce((function(e,t){return e+=Number(t.order_product.quantity)*Number(t.price)}),0);return e+Number(c)}),0);f+=c;var a=t.reduce((function(e,t){return e.concat(t.products.map((function(e){return Object(y.a)(Object(y.a)({},e),{},{orderStatusId:t.orderStatusId,orderStatusName:t.orderStatus.name})})))}),[]),n=Object(Ze.a)(a,"name");return{status:e,money:c,quantity:Object.keys(n).map((function(e){return{type:e,value:n[e].reduce((function(e,t){return e+=Number(t.order_product.quantity*(t.unitWeight||1))}),0)}}))}})),x=Object.keys(O).map((function(e){return{type:e,value:O[e].reduce((function(e,t){return e.all+=Number(t.order_product.quantity*(t.unitWeight||1)),1===t.orderStatusId&&(e.raw+=Number(t.order_product.quantity*(t.unitWeight||1))),e}),{all:0,raw:0}).all}})),g=x.reduce((function(e,t){return e+Number(t.value)}),0),v={appendPadding:10,data:x,angleField:"value",colorField:"type",radius:1,innerRadius:.6,label:{autoRotate:!1,type:"inner",offset:"-50%",content:"{value}",style:{textAlign:"center",fontSize:17}},statistic:{title:!1,content:{style:{whiteSpace:"pre-wrap",overflow:"hidden",textOverflow:"ellipsis"},formatter:function(){return"\u0412\u0441\u0435\u0433\u043e ".concat(g)}}}};return Object(a.useEffect)((function(){o(!0),$.get("/orders",{params:d}).then((function(e){n(e.data)})).catch((function(){})).finally((function(){o(!1)}))}),[d]),Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(qe.a.RangePicker,{style:{marginBottom:"50px",width:300},value:ct(d.createdAt),onChange:function(e,t){!function(e){b((function(t){return Object(y.a)(Object(y.a)({},t),e)}))}({createdAt:JSON.stringify(t)})}}),Object(M.jsxs)(Je.a,{title:"\u0421\u0443\u043c\u043c\u0430 \u043f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0430\u043c (BYN)",bordered:!0,layout:"vertical",style:{marginBottom:50},children:[p.map((function(e){return Object(M.jsxs)(Je.a.Item,{label:e.status,children:[e.quantity.map((function(e){return Object(M.jsxs)(a.Fragment,{children:[Object(M.jsxs)("b",{children:[e.type,":"]})," ",e.value," \u043a\u0433",Object(M.jsx)("br",{})]},e.type)})),e.money," BYN"]},e.status)})),Object(M.jsxs)(Je.a.Item,{label:"\u0412\u0441\u0435\u0433\u043e",children:[x.map((function(e){return Object(M.jsxs)(a.Fragment,{children:[Object(M.jsxs)("b",{children:[e.type,":"]})," ",e.value," \u043a\u0433",Object(M.jsx)("br",{})]},e.type)})),f," BYN"]})]}),Object(M.jsx)(Xe.a,Object(y.a)(Object(y.a)({},v),{},{loading:i}))]})},nt=b.a.Content,rt=b.a.Sider,st=[{path:"/",component:Object(M.jsx)(Z,{})},{path:"/orders/new",component:Object(M.jsx)(Ve,{})},{path:"/orders/:id/edit",component:Object(M.jsx)(De,{})},{path:"/orders/:id",component:Object(M.jsx)(Be,{})},{path:"/users",component:Object(M.jsx)(te,{})},{path:"/users/new",component:Object(M.jsx)(be,{})},{path:"/users/:id",component:Object(M.jsx)(je,{})},{path:"/customers",component:Object(M.jsx)(Pe,{})},{path:"/customers/new",component:Object(M.jsx)(Le,{})},{path:"/customers/:id",component:Object(M.jsx)(_e,{})},{path:"/customers/:id/edit",component:Object(M.jsx)(He,{})},{path:"/products",component:Object(M.jsx)(Re,{})},{path:"/products/new",component:Object(M.jsx)(Ge,{})},{path:"/products/:id/edit",component:Object(M.jsx)(Qe,{})},{path:"/profile",component:Object(M.jsx)(ue,{})},{path:"/statistics",component:Object(M.jsx)(at,{})}],it=function(){var e=k(),t=Object(j.a)(e,3)[2],c=Object(d.g)(),n=Object(a.useMemo)((function(){return c.pathname.match("/users")?"users":c.pathname.match("/customers")?"customers":c.pathname.match("/products")?"products":c.pathname.match("/profile")?"profile":c.pathname.match("/statistics")?"statistics":"orders"}),[c.pathname]);return Object(M.jsxs)(b.a,{children:[Object(M.jsxs)(rt,{breakpoint:"lg",collapsedWidth:"0",children:[Object(M.jsx)("div",{className:"logo",children:"Berrymore Admin"}),Object(M.jsxs)(m.a,{theme:"dark",mode:"inline",selectedKeys:[n],children:[Object(M.jsx)(m.a.Item,{icon:Object(M.jsx)(O.a,{}),children:Object(M.jsx)(u.b,{to:"/",children:"\u0417\u0430\u043a\u0430\u0437\u044b"})},"orders"),t&&Object(M.jsx)(m.a.Item,{icon:Object(M.jsx)(h.a,{}),children:Object(M.jsx)(u.b,{to:"/users",children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"})},"users"),Object(M.jsx)(m.a.Item,{icon:Object(M.jsx)(f.a,{}),children:Object(M.jsx)(u.b,{to:"/customers",children:"\u0417\u0430\u043a\u0430\u0437\u0447\u0438\u043a\u0438"})},"customers"),Object(M.jsx)(m.a.Item,{icon:Object(M.jsx)(p.a,{}),children:Object(M.jsx)(u.b,{to:"/products",children:"\u0422\u043e\u0432\u0430\u0440\u044b"})},"products"),Object(M.jsx)(m.a.Item,{icon:Object(M.jsx)(x.a,{}),children:Object(M.jsx)(u.b,{to:"/profile",children:"\u041f\u0440\u043e\u0444\u0438\u043b\u044c"})},"profile"),t&&Object(M.jsx)(m.a.Item,{icon:Object(M.jsx)(g.a,{}),children:Object(M.jsx)(u.b,{to:"/statistics",children:"\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430"})},"statistics")]})]}),Object(M.jsxs)(b.a,{children:[Object(M.jsx)(E,{}),Object(M.jsx)(nt,{style:{margin:"24px 16px 0"},children:Object(M.jsx)("div",{className:"site-layout-background",style:{padding:24},children:t?Object(M.jsx)(d.c,{children:st.map((function(e){return Object(M.jsx)(d.a,{exact:!0,path:e.path,children:e.component},e.path)}))}):Object(M.jsx)(d.c,{children:st.filter((function(e){return!e.path.match("/users")||!e.path.match("/statistics")})).map((function(e){return Object(M.jsx)(d.a,{exact:!0,path:e.path,children:e.component},e.path)}))})})})]})]})},ot=(c(1371),c(1408)),ut=(c(1372),function(){var e=k(),t=Object(j.a)(e,2)[1],c=Object(a.useState)(!1),n=Object(j.a)(c,2),r=n[0],s=n[1];return Object(M.jsx)("div",{className:"login-form-wrapper",children:Object(M.jsx)("div",{className:"login-form-container",children:Object(M.jsxs)(ce.a,{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:function(e){s(!0),$.post("/auth/signin",{username:e.username,password:e.password}).then((function(e){e.data.accessToken&&localStorage.setItem("token",e.data.accessToken),t(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0432\u0445\u043e\u0434"})})).finally((function(){s(!1)}))},children:[Object(M.jsx)(ce.a.Item,{name:"username",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043b\u043e\u0433\u0438\u043d"}],children:Object(M.jsx)(Y.a,{prefix:Object(M.jsx)(x.a,{className:"site-form-item-icon"}),placeholder:"\u041b\u043e\u0433\u0438\u043d"})}),Object(M.jsx)(ce.a.Item,{name:"password",rules:[{required:!0,message:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"}],children:Object(M.jsx)(Y.a.Password,{prefix:Object(M.jsx)(ot.a,{className:"site-form-item-icon"}),type:"password",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"})}),Object(M.jsx)(ce.a.Item,{children:Object(M.jsx)(F.a,{loading:r,type:"primary",htmlType:"submit",className:"login-form-button",children:"\u0412\u043e\u0439\u0442\u0438"})})]})})})}),lt=(c(1373),{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:10}}}),dt=function(){var e=ce.a.useForm(),t=Object(j.a)(e,1)[0],c=Object(a.useState)(!1),n=Object(j.a)(c,2),r=n[0],s=n[1],i=Object(a.useState)(!1),o=Object(j.a)(i,2),u=o[0],l=o[1],d=Object(a.useState)([]),b=Object(j.a)(d,2),m=b[0],O=b[1],h=Object(a.useState)(!1),f=Object(j.a)(h,2),p=f[0],x=f[1];Object(a.useEffect)((function(){x(!0),$.get("/products").then((function(e){O(e.data)})).catch((function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u044b"})})).finally((function(){x(!1)}))}),[O,x]);return u?Object(M.jsxs)("div",{style:{maxWidth:750,margin:"50px auto 30px auto",padding:"20px"},children:[Object(M.jsx)("h1",{children:"\u0412\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d!"}),Object(M.jsx)("h3",{children:"\u041c\u044b \u0441\u0432\u044f\u0436\u0435\u043c\u0441\u044f \u0441 \u0432\u0430\u043c\u0438 \u043a\u0430\u043a \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u043c\u043e\u0436\u0435\u043c. \u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0447\u0442\u043e \u0432\u044b\u0431\u0440\u0430\u043b\u0438 \u043d\u0430\u0441!"}),Object(M.jsx)("a",{href:"http://berrymore.by",children:Object(M.jsx)(F.a,{size:"large",children:"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043d\u0430 \u0441\u0430\u0439\u0442"})})]}):Object(M.jsxs)("div",{className:"order-form",children:[Object(M.jsx)("div",{style:{maxWidth:750,margin:"50px auto 30px auto"},children:Object(M.jsxs)("h3",{children:["\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0432\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0438\u043d\u0442\u0435\u0440\u0435\u0441\u0443\u044e\u0449\u0438\u0435 \u0432\u0430\u0441 \u0442\u043e\u0432\u0430\u0440\u044b, \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f \u043f\u043e\u043c\u0435\u0447\u0435\u043d\u043d\u044b\u0435 ",Object(M.jsx)("span",{style:{color:"red"},children:"*"})," \u0438 \u043d\u0430\u0436\u043c\u0438\u0442\u0435 \u043a\u043d\u043e\u043f\u043a\u0443 ",Object(M.jsx)("b",{children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"}),". \u041f\u043e\u0437\u0436\u0435 \u043c\u044b \u0441\u0432\u044f\u0436\u0435\u043c\u0441\u044f \u0441 \u0432\u0430\u043c\u0438 \u043f\u043e \u0443\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u043c \u043a\u043e\u043d\u0442\u0430\u043a\u0442\u0430\u043c."]})}),Object(M.jsxs)(ce.a,{layout:"vertical",form:t,name:"order",onFinish:function(e){var t=[];e.products&&e.products.length?e.products.some((function(e){return!e.quantity}))&&t.push("\u041d\u0435 \u0443\u043a\u0430\u0437\u0430\u043d\u043e \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u0430"):t.push("\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u044b \u0442\u043e\u0432\u0430\u0440\u044b"),e.products.reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+(t.quantity||0)}),0)<10&&3===e.deliveryMethodId&&t.push("\u042f\u043d\u0434\u0435\u043a\u0441 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u0430 \u0442\u043e\u043b\u044c\u043a\u043e \u043f\u0440\u0438 \u0437\u0430\u043a\u0430\u0437\u0435 \u043e\u0442 10 \u043a\u0433"),t.length?z.a.error({message:t.join(". ")}):(s(!0),$.post("/orders",e).then((function(){z.a.success({message:"\u0417\u0430\u043a\u0430\u0437 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d"}),l(!0)}),(function(){z.a.error({message:"\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u043e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437"})})).finally((function(){s(!1)})))},initialValues:{deliveryMethodId:1,orderStatusId:1,paymentMethod:"\u041d\u0430\u043b\u0438\u0447\u043d\u044b\u0435",products:[{id:null,quantity:1}]},scrollToFirstError:!0,style:{maxWidth:750,margin:"0 auto",paddingBottom:30},children:[Object(M.jsx)(Ce,{form:t,products:m,productsLoading:p}),Object(M.jsx)(ze,{form:t}),Object(M.jsx)(Me,{validatePhone:!0}),Object(M.jsx)(ce.a.Item,{name:"notes",label:"\u0414\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u0438 \u043f\u043e\u0436\u0435\u043b\u0430\u043d\u0438\u044f",children:Object(M.jsx)(Y.a.TextArea,{})}),Object(M.jsx)(ce.a.Item,{shouldUpdate:!0,children:function(){var e=(t.getFieldValue("products")||[]).reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=m.find((function(e){return e.id===t.id}))||{};return e+(t.quantity*c.price||0)}),0);return"\u0418\u0442\u043e\u0433\u043e \u043a \u043e\u043f\u043b\u0430\u0442\u0435: ".concat(e," BYN")}}),Object(M.jsx)(ce.a.Item,Object(y.a)(Object(y.a)({},lt),{},{children:Object(M.jsx)(F.a,{type:"primary",htmlType:"submit",size:"large",loading:r,children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})}))]})]})};_.a.locale("ru");var jt=function(){var e=Object(l.b)(),t=Object(l.c)(N);return Object(a.useEffect)((function(){var t=JSON.parse(localStorage.getItem("user"));t&&e(S(t))}),[e]),t?Object(M.jsx)(it,{}):Object(M.jsxs)(d.c,{children:[Object(M.jsx)(d.a,{exact:!0,path:"/",children:Object(M.jsx)(ut,{})}),Object(M.jsx)(d.a,{exact:!0,path:"/order_form",children:Object(M.jsx)(dt,{})})]})},bt=Object(v.a)({reducer:{auth:w}}),mt=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,1409)).then((function(t){var c=t.getCLS,a=t.getFID,n=t.getFCP,r=t.getLCP,s=t.getTTFB;c(e),a(e),n(e),r(e),s(e)}))};c(1374);o.a.render(Object(M.jsx)(l.a,{store:bt,children:Object(M.jsx)(n.a,{locale:s.a,children:Object(M.jsx)(u.a,{children:Object(M.jsx)(jt,{})})})}),document.getElementById("root")),mt()},580:function(e,t,c){}},[[1380,1,2]]]);
//# sourceMappingURL=main.6c85005a.chunk.js.map